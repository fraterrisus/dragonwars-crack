# Game State

## Board State Bits

| Heap byte |    Bit     | Board                | Meaning                                                    |
| :-------: | :--------: | -------------------- | ---------------------------------------------------------- |
|  `[9c]`   | `–*––––––` | Purgatory            | (20,13) Start square intro message has been played         |
|  `[9d]`   | `–––––*––` | Purgatory            | Defeated the Humbaba                                       |
|  `[9d]`   | `––––––*–` | Purgatory            | Have received reward from Clopin for defeating the Humbaba |
|  `[a5]`   | `––*–––––` | Purgatory            | Defeated the Gladiators in the Arena                       |
|  `[b9]`   | `––*–––––` | Purgatory            | Have been shown para #4 when entering the Arena            |
|  `[b9]`   | `––––*–––` | Purgatory            | (25,08) "Dive into the harbor" message has been played     |
|  `[b9]`   | `–––––*––` | Purgatory            | (06,13) Have successfully prayed to Irkalla                |
|  `[a9]`   | `–*––––––` | Magan Underworld     | Have taken the 5 AP Leap of Faith                          |
|  `[9c]`   | `–––––––*` | Sunken Ruins (below) | Clam has been brought to surface and replaced with Skull   |
|  `[9d]`   | `*–––––––` | Sunken Ruins (below) |                                                            |
|  `[b9]`   | `*–––––––` | Sunken Ruins (below) | Intro message has been played                              |
|  `[b9]`   | `–*––––––` | Sunken Ruins (below) | Clam has been picked up                                    |
|  `[b9]`   | `––––––*–` | Sunken Ruins (below) | Chest has been unlocked                                    |

## Marching Order

Heap bytes `[0a-10]` represent slots 1–7 in the marching order; the value of the byte indexes the character in the data file, but it's doubled to make the math easier, because each character occupies two "blocks" of `0x100` bytes.

| Index  | Character data pointer |
| :----: | :--------------------: |
| `0x00` |        `0x2e19`        |
| `0x02` |        `0x3019`        |
| `0x04` |        `0x3219`        |
| `0x06` |        `0x3419`        |
| `0x08` |        `0x3619`        |
| `0x0a` |        `0x3819`        |
| `0x0c` |        `0x3a19`        |

## NPCs in party

Spread between bit 0x01 of 0x3cbc and all bits of 0x3cbd. This value is generated by reading the NPC IDs from each character's data blob; it's saved in the game state, but the saved value is ignored.

|     Bits     |   NPC   |
| :----------: | :-----: |
| `1 ––––––––` |  Ulrik  |
| `– 1–––––––` |    ?    |
| `– –1––––––` |  Louie  |
| `– ––1–––––` |  Valar  |
| `– –––1––––` | Halifax |
| `– ––––1–––` |    ?    |
| `– –––––1––` |    ?    |
| `– ––––––1–` |    ?    |
| `– –––––––1` |    ?    |
